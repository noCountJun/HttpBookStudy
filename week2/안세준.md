# 3장. HTTP 메시지

## 1. 메시지의 흐름
> - 메시지는 애플리케이션 간에 주고받은 데이터의 블록들이다.
> - 클라이언트,서버,프락시 사이를 흐른다
> - 메시지의 방향을 의미하는 용어는 인바운드, 아웃바운드, 업스트림, 다운스트림이 있다

#### 1. 메시지는 원 서버 방향을 인바운드로 하여 송신된다

- 메시지가 원 서버로 향하는 것을 **인바운드**로 이동하는 것이라고 하고
  모든 처리가 끝나고 사용자 에이전트로 돌아오는 것을 **아웃바운드**로 이동하는 것이라 한다

#### 2. 다운스트림으로 흐르는 메시지

- 요청, 응답에 관계없이 모든 메시지는 **다운스트림**으로 흐른다
- 메시지의 발송자는 수신자의 **업스트림**이다.
- ex) 그림 3-2 (51p)


## 2. 메시지의 각 부분

#### 1. 메시지 문법

> - 요청 메시지는 어떤 동작을 요구하고, 
> - 응답 메시지는 요청의 결과를 클라이언트에게 돌려준다
> - 요청 메시지 
> <메서드><요청 URL><버전>
> <헤더>
> 
> <엔터티본문>

> - 응답 메시지
> <버전><상태코드><사유 구절>
> <헤더>
> 
> <엔터티 본문>

- 메서드
  - 클라이언트 측에서 서버가 리소스에 대해 수행해 주길 바라는 동작
  - GET, HEAD, POST 등 (추
- 요청 URL
  - 완전한 URL 혹은 URL 경로 구성 요소
  - 절대 경로이기만 하면 문제가 없다
- 버전
  - HTTP의 버전
- 상태코드
  - 요청 중에 무엇이 일어났는지 설명하는 세자리 숫자
- 사유구절(reason-phrase) : 리즈 프(f)레이즈
  - 사람이 이해할 수 있게 설명해주는 상태코드의 의미
  - 오직 사람에게만 읽히기 위한 목적
  - 사유구절이 not ok 라도 상태코드가 200이면 성공
- 헤더들
  - 이름,콜론(:),선택적 공백, 값, CRLF(줄바꿈) 가 순서대로 나타나는 0개 이상의 헤더들
- 엔터티 본문
  - 임의의 데이터 블록을 포함
  - 본문이 없어도 헤더는 CRLF(줄바꿈)으로 끝난다
  - 그러나 역사적으로 CRLF를 빠뜨린 경우도 많으므로, 
    클라이언트와 서버는 마지막에 CRLF 없이 끝나는 메시지도 받아들일 수 있어야 한다.



#### 2. 시작줄

> 모든 HTTP 메시지는 시작줄로 시작한다.

- 요청줄
  - 요청 메시지의 시작줄
  - 메서드, 요청URL, HTTP버전이 포함
  - 필드는 공백으로 구분
- 응답줄
  - 응답 메시지의 시작줄
  - HTTP버전,상태코드,사유구절이 포함
  - 필드는 공백으로 구분
- 메서드
  - 많이쓰는 HTTP 메서드는 7개
    - GET : 어떤 문서를 가져온다
    - HEAD : 어떤 문서에 대해 헤더만 가져온다
    - POST : 처리해야할 데이터를 보낸다
    - PUT : 요청 메시지의 본문을 저장
    - TRACE : 메시지가 프락시에 거쳐 서버에 도달하는 과정을 추적
    - OPTIONS : 서버가 어떤 메서드를 수행할 수 있는지 확인
    - DELETE : 문서를 제거
- 상태코드
  - 요청 중에 무엇이 일어났는지 설명하는 세자리 숫자
    - 100~ : 정보
    - 200~ : 성공
    - 300~: 리다이렉션
    - 400~: 클라이언트에러
    - 500~: 서버 에러
- 사유구절
  - 상태코드와 1:1로 대응
  - HTTP 명세는 사유구절이 어때야 한다는 어떤 규칙도 없다
- 버전번호
  - HTTP/x.y 형식
  - HTTP 애플리케이션들이 자신이 따르는 프로토콜의 버전을 상대방에게 말해주기 위한 수단
  - 각 숫자는 따로따로 비교해야한다 
    - ex) HTTP/2.22는 HTTP/2.3 보다 크다.   22 > 3

#### 3. 헤더

> 요청과 응답 메시지에 추가 정보를 더한다
> 이름/값의 목록 

- 헤더분류
  - 일반 헤더 : 요청과 응답 양쪽에 모두 있을 수 있음
  - 요청 헤더 : 요청에 대한 부가정보를 제공
  - 응답 헤더 : 응답에 대한 부가정보를 제공
  - Entity 헤더 : 본문 크기와 컨텐츠, 혹은 리소스 그자체를 서술
  - 확장헤더 : 명세에 정의되지 않은 헤더
    
- 헤더를 여러줄로 나누기
  - 길면 여러줄로 쪼갤수 있다
    - ex) Server : Test Server 
      			Version 1.0
      = Server : Test Server Version 1.0

#### 4. 엔터티 본문

- HTTP가 수송하도록 설계된 것들의 화물
- HTTP 메시지는 이미지, 비디오, 문서, 전자우편 등 여러 종류의 디지털 데이터를 실어 나를 수 있다

#### 5. 버전 0.9 메시지

- 여전히 사용하는 클라이언트, 서버, 기타 애플리케이션 들이 있기 때문에 제약에 대해 알아둘 필요가 있다
- HTTP/0.9 메시지의 요청은 그저 메서드와 요청 URL만 갖고 있고, 응답은 오직 엔티티로만 되어 있다
